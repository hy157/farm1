<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Modern Farm Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --main-green: #34af23;
      --darker-green: #218c13;
      --bar-bg: #fff;
      --bar-border: #ccc;
      --panel-bg: #f8fff6;
      --panel-border: #9cbe9b;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: var(--main-green);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    #top-bar, #bottom-bar {
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: var(--darker-green);
      color: #fff;
      font-size: 1.1em;
      padding: 0.8em 0.2em;
      min-height: 48px;
    }
    #top-bar span {
      margin: 0 8px;
      font-weight: 600;
      background: var(--bar-bg);
      color: #222;
      padding: 0.3em 1em;
      border-radius: 1em;
      border: 1.5px solid var(--bar-border);
      box-shadow: 0 1px 2px #0001;
    }
    #game-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 1em 0.4em 0.6em 0.4em;
    }
    #fields-grid {
      display: flex;
      flex-direction: column;
      gap: 1em;
      width: 100%;
      max-width: 360px;
      margin: 1em auto 0 auto;
    }
    .field {
      width: 100%;
      aspect-ratio: 6/1.5;
      background: var(--panel-bg);
      border: 2.5px solid var(--panel-border);
      border-radius: 1.2em;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2em;
      color: #222;
      cursor: pointer;
      transition: box-shadow 0.15s;
      box-shadow: 0 2px 6px #0001;
      position: relative;
      overflow: hidden;
    }
    .field.locked {
      filter: grayscale(0.8);
      opacity: 0.65;
      cursor: not-allowed;
      pointer-events: none;
    }
    .field .progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 5px;
      background: linear-gradient(90deg, #6fdb5f, #ffc107);
      transition: width 0.3s;
    }
    .buildings-bar {
      display: flex;
      flex-direction: row;
      gap: 0.5em;
      margin: 0.5em 0;
      justify-content: center;
    }
    .building {
      background: #fffbe7;
      border: 2px solid #f1cf76;
      color: #764a01;
      border-radius: 0.7em;
      padding: 0.4em 1em;
      min-width: 80px;
      text-align: center;
      font-size: 0.95em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 7px #0002;
      margin: 0 0.2em;
    }
    #bottom-bar button {
      background: #fff;
      border: none;
      color: #218c13;
      font-size: 1.1em;
      padding: 0.6em 1.3em;
      border-radius: 1em;
      font-weight: 600;
      margin: 0 0.4em;
      box-shadow: 0 2px 4px #0001;
      cursor: pointer;
      transition: background 0.18s;
    }
    #bottom-bar button:hover {
      background: #e8fbd5;
    }
    /* Modals */
    .modal {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 2.1em 1.2em 1.2em 1.2em;
      border-radius: 1.4em;
      box-shadow: 0 5px 40px #0005;
      min-width: 270px;
      max-width: 90vw;
      z-index: 2000;
      border: 2.5px solid #aad8a3;
      display: none;
      flex-direction: column;
      align-items: center;
      font-size: 1.1em;
    }
    .modal.active {
      display: flex;
      animation: popIn 0.2s;
    }
    @keyframes popIn { 0%{scale:0.8; opacity:0} 100%{scale:1; opacity:1} }
    .modal h2 {
      margin: 0 0 1em 0;
      font-size: 1.25em;
      color: #277214;
    }
    .modal button {
      margin-top: 1em;
      min-width: 100px;
    }
    .store-item {
      margin: 0.5em 0;
      background: #e3ffd1;
      border: 1px solid #ceeab5;
      border-radius: 0.7em;
      padding: 0.7em 1.2em;
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      box-sizing: border-box;
    }
    .store-item button {
      font-size: 0.99em;
      padding: 0.2em 1em;
      margin-left: 0.6em;
    }
    .close-btn {
      background: #d1ffd5 !important;
      color: #134f14 !important;
      margin-top: 2em;
    }
    /* Responsive */
    @media (max-width: 600px) {
      #fields-grid { max-width: 99vw; }
      .modal { min-width: 90vw; }
    }
  </style>
</head>
<body>
  <div id="top-bar">
    <span id="energy-bar">‚ö° 100</span>
    <span id="coin-bar">üí∞ 100</span>
    <span id="gem-bar">üíé 100</span>
  </div>

  <div id="game-area">
    <div class="buildings-bar" id="buildings-bar"></div>
    <div id="fields-grid"></div>
  </div>

  <div id="bottom-bar">
    <button onclick="openDepot()">üì¶ Depo</button>
    <button onclick="openStore()">üè™ Maƒüaza</button>
    <button onclick="openTasks()">üìù G√∂revler</button>
  </div>

  <!-- Store Modal -->
  <div class="modal" id="store-modal">
    <h2>Maƒüaza</h2>
    <div class="store-item">
      üü´ <span>Tarla (10 coin)</span>
      <button onclick="buyField()">Al</button>
    </div>
    <div class="store-item">
      üè≠ <span>Deƒüirmen (30 coin)</span>
      <button onclick="buyBuilding('mill')">Al</button>
    </div>
    <div class="store-item">
      üö∞ <span>Su Kuyusu (20 coin)</span>
      <button onclick="buyBuilding('well')">Al</button>
    </div>
    <div class="store-item">
      üî• <span>Fƒ±rƒ±n (40 coin)</span>
      <button onclick="buyBuilding('oven')">Al</button>
    </div>
    <button class="close-btn" onclick="closeModal('store-modal')">Kapat</button>
  </div>
  <!-- Depot Modal -->
  <div class="modal" id="depot-modal">
    <h2>Depo</h2>
    <div id="depot-list">Depo bo≈ü.</div>
    <button class="close-btn" onclick="closeModal('depot-modal')">Kapat</button>
  </div>
  <!-- Task Modal -->
  <div class="modal" id="task-modal">
    <h2>G√∂revler</h2>
    <div>G√∂rev sistemi √ßok yakƒ±nda! üõ†Ô∏è</div>
    <button class="close-btn" onclick="closeModal('task-modal')">Kapat</button>
  </div>
  <!-- Plant Modal -->
  <div class="modal" id="plant-modal">
    <h2>√úr√ºn Se√ß</h2>
    <div id="plant-options"></div>
    <button class="close-btn" onclick="closeModal('plant-modal')">Vazge√ß</button>
  </div>
  <!-- Building Modal -->
  <div class="modal" id="building-modal">
    <h2 id="building-title">√úretim Binasƒ±</h2>
    <div id="building-content">ƒ∞√ßerik</div>
    <button class="close-btn" onclick="closeModal('building-modal')">Kapat</button>
  </div>

  <script>
    // ----------- GAME STATE ----------
    let state = {
      coins: 100,
      energy: 100,
      gems: 100,
      fields: [{empty: true},{empty: true},{empty: true},{empty: true},{empty: true}],
      depot: {},
      buildings: [], // {type:'mill'|'well'|'oven'}
      crops: [
        {name: "Buƒüday", emoji:"üåæ", time: 10, price: 5},
        {name: "Mƒ±sƒ±r", emoji:"üåΩ", time: 25, price: 8},
        {name: "Domates", emoji:"üçÖ", time: 45, price: 14},
        {name: "Kabak", emoji:"üéÉ", time: 80, price: 20},
        {name: "√áilek", emoji:"üçì", time: 120, price: 32}
      ],
      cropPlanting: null,
      buildingsInfo: {
        mill: {name:"Deƒüirmen",emoji:"üè≠"},
        well: {name:"Su Kuyusu",emoji:"üö∞"},
        oven: {name:"Fƒ±rƒ±n",emoji:"üî•"},
      }
    };

    // --------- UI UPDATERS -----------
    function updateBars() {
      document.getElementById('energy-bar').innerText = `‚ö° ${state.energy}`;
      document.getElementById('coin-bar').innerText = `üí∞ ${state.coins}`;
      document.getElementById('gem-bar').innerText = `üíé ${state.gems}`;
    }
    function renderFields() {
      const grid = document.getElementById('fields-grid');
      grid.innerHTML = "";
      state.fields.forEach((field, i) => {
        const div = document.createElement('div');
        div.className = "field";
        if(field.locked) div.classList.add('locked');
        if(field.empty) div.innerHTML = "Bo≈ü Tarla üü´";
        else if(field.growing) {
          div.innerHTML = `<span>${field.crop.emoji} ${field.crop.name}<br><small>${field.crop.time-strTime(field.progress)} sn</small></span>`;
          const prog = document.createElement('div');
          prog.className = "progress";
          prog.style.width = `${Math.max(3,field.progress/field.crop.time*100)}%`;
          div.appendChild(prog);
        }
        else if(field.ready) {
          div.innerHTML = `${field.crop.emoji} ${field.crop.name} ‚úÖ<br><button onclick="harvestField(${i})">Hasat Et</button>`;
        }
        div.onclick = () => { if(field.empty) openPlantModal(i); };
        grid.appendChild(div);
      });
    }
    function renderBuildings() {
      const bar = document.getElementById('buildings-bar');
      bar.innerHTML = "";
      state.buildings.forEach((b, idx) => {
        const d = document.createElement('div');
        d.className = "building";
        d.innerHTML = `${state.buildingsInfo[b.type].emoji} <span>${state.buildingsInfo[b.type].name}</span>`;
        d.onclick = () => openBuildingModal(b.type, idx);
        bar.appendChild(d);
      });
    }
    function updateDepot() {
      const list = document.getElementById('depot-list');
      if(Object.keys(state.depot).length==0) list.innerHTML = "Depo bo≈ü.";
      else {
        list.innerHTML = "";
        Object.entries(state.depot).forEach(([crop,amount])=>{
          list.innerHTML += `<div>${crop} x${amount} <button onclick="sellCrop('${crop}')">Sat</button></div>`;
        });
      }
    }

    // -------- MODALS -----------
    function openStore() { openModal('store-modal'); }
    function openDepot() { updateDepot(); openModal('depot-modal'); }
    function openTasks() { openModal('task-modal'); }
    function openPlantModal(fieldIdx) {
      state.cropPlanting = fieldIdx;
      const options = document.getElementById('plant-options');
      options.innerHTML = "";
      state.crops.forEach((crop, i)=>{
        options.innerHTML += `<button onclick="plantCrop(${i})">${crop.emoji} ${crop.name}<br><small>${crop.time} sn / ${crop.price} coin</small></button>`;
      });
      openModal('plant-modal');
    }
    function openBuildingModal(type, idx) {
      document.getElementById('building-title').innerText = state.buildingsInfo[type].name + " " + state.buildingsInfo[type].emoji;
      let content = '';
      if(type=='mill') content = "Burada √ºr√ºnlerden un √ºretebilirsin. (Demo)";
      if(type=='well') content = "Tarlanƒ± √ºcretsiz sulayabilirsin. (Demo)";
      if(type=='oven') content = "Un ve √ºr√ºnlerden ekmek √ºretebilirsin. (Demo)";
      document.getElementById('building-content').innerHTML = content;
      openModal('building-modal');
    }
    function openModal(id) {
      document.getElementById(id).classList.add('active');
    }
    function closeModal(id) {
      document.getElementById(id).classList.remove('active');
    }

    // ----------- GAME LOGIC -----------
    function buyField() {
      // Tarla satƒ±n al
      let idx = state.fields.findIndex(f=>f.locked);
      if(idx<0) idx = state.fields.findIndex(f=>f.empty);
      if(idx < 0) return alert("T√ºm tarlalar zaten a√ßƒ±k!");
      if(state.coins < 10) return alert("Yeterli coin yok!");
      state.coins -= 10;
      state.fields[idx] = {empty: true};
      renderFields(); updateBars();
    }
    function buyBuilding(type) {
      let price = type=='mill'?30:type=='well'?20:40;
      if(state.coins < price) return alert("Yeterli coin yok!");
      state.coins -= price;
      state.buildings.push({type});
      renderBuildings(); updateBars();
    }
    function plantCrop(cropIdx) {
      closeModal('plant-modal');
      let fidx = state.cropPlanting;
      if(state.energy < 10) return alert("Yeterli enerji yok!");
      let field = state.fields[fidx];
      if(!field.empty) return;
      let crop = {...state.crops[cropIdx]};
      state.energy -= 10;
      if(state.gems > 0) {
        state.gems -= 1;
        state.fields[fidx] = {growing:false, ready:true, crop};
        renderFields(); updateBars();
        return;
      }
      state.fields[fidx] = {empty:false, growing:true, progress:0, crop};
      renderFields(); updateBars();
    }
    function harvestField(idx) {
      let field = state.fields[idx];
      let c = field.crop.name;
      state.depot[c] = (state.depot[c]||0) + 1;
      state.fields[idx] = {empty:true};
      renderFields(); updateDepot(); updateBars();
    }
    function sellCrop(crop) {
      if(state.depot[crop]>0) {
        let price = state.crops.find(c=>c.name==crop).price;
        state.coins += price;
        state.depot[crop] -= 1;
        if(state.depot[crop]==0) delete state.depot[crop];
        updateDepot(); updateBars();
      }
    }
    // Timer
    setInterval(()=>{
      state.fields.forEach((field,i)=>{
        if(field.growing) {
          field.progress = (field.progress||0)+1;
          if(field.progress >= field.crop.time) {
            field.growing = false; field.ready = true;
          }
        }
      });
      renderFields();
    }, 1000);
    function strTime(sec) {
      return Math.max(0, sec);
    }
    // --------- INIT -----------
    function init() {
      // 5 tarladan fazlasƒ±nƒ± a√ßmak i√ßin locked ekleyebilirsin
      while(state.fields.length < 5) state.fields.push({locked:true});
      renderFields();
      renderBuildings();
      updateBars();
    }
    init();
  </script>
</body>
</html>
